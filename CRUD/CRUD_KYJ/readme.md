# CRUD

<aside>
üìë Contents

</aside>

## ÌîÑÎ°úÏ†ùÌä∏ ÏÉùÏÑ±

### 1. Spring Initializr

![Untitled](CRUD%2065071a652daf4f07845a865d25351caf/Untitled.png)

---

### 2. Íµ¨Ï°∞ ÏÑ§Í≥Ñ

![Untitled](CRUD%2065071a652daf4f07845a865d25351caf/Untitled%201.png)

1. **domain(entity)**
    - Í∞ùÏ≤¥
    - Í∏Ä id, Í∏Ä Ï†úÎ™©, Í∏Ä ÎÇ¥Ïö©
    - Ïû•Í≥† Î™®Îç∏ Article
2. **repository**
    - Article.save(), Article.findById()
    - Í∞ùÏ≤¥ Ï†ÄÏû•, ÏàòÏ†ï, ÏÇ≠Ï†ú, Ï∞æÍ∏∞ Îì±Îì±‚Ä¶.
3. **Service**
    - ÎπÑÏ¶àÎãàÏä§ Î°úÏßÅ
    - Í≤åÏãúÌåê Í∏Ä Ï†ÄÏû•, Í≤åÏãúÌåê Í∏Ä ÏÇ≠Ï†ú, Í≤åÏãúÌåê Îì±Î°ù
4. **Controller**
    - URL + View
    - ÏÇ¨Ïö©Ïûê ÏöîÏ≤≠ ‚Üí /article/save(service) ‚Üí ÏùëÎãµ

## Create, Read

### 1. Domain(Model)

```java
package com.example.CRUD_practice.domain;

public class Article {

    private Long id;
    private String title;
    private String content;
    private String author;

    public Long getId() {
        return id;
    }

    public void setId(Long id) {
        this.id = id;
    }

    public String getTitle() {
        return title;
    }

    public void setTitle(String title) {
        this.title = title;
    }

    public String getContent() {
        return content;
    }

    public void setContent(String content) {
        this.content = content;
    }

    public String getAuthor() {
        return author;
    }

    public void setAuthor(String author) {
        this.author = author;
    }
}
```

---

### 2. Repository

```java
package com.example.CRUD_practice.repository;

import com.example.CRUD_practice.domain.Article;
import org.springframework.stereotype.Component;
import org.springframework.stereotype.Repository;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

@Repository // Îπà Îì±Î°ù
public class ArticleRepository {
    private static final Map<Long, Article> store = new HashMap<>(); // ÏÉÅÏàò, ÏµúÏ¢Ö

    private static long sequence = 0L;

    public Article save(Article article) {
        article.setId(++sequence);
        store.put(article.getId(), article); // put -> map Ìï®Ïàò Í∏∞Îä•, Í∞í ÎÑ£Í∏∞ (key: id, val:article)
        return article;
    }

    public Article findById(Long id) {
        return store.get(id);
    }

    public List<Article> findAll() {
        return new ArrayList<>(store.values());
    }

    public void update(Long articleId, Article updateParam) {
        Article findArticle = findById(articleId);

        findArticle.setTitle(updateParam.getTitle());
        findArticle.setContent(updateParam.getContent());
        findArticle.setAuthor(updateParam.getAuthor());
    }

    public void clearStore() {
        store.clear();
    }

    public void delete(Long id) {
        store.remove(id);
    }
}
```

---

### 3. Service

```java
package com.example.CRUD_practice.service;

import com.example.CRUD_practice.domain.Article;
import com.example.CRUD_practice.repository.ArticleRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import java.util.List;

@Service
public class ArticleService {

    private final ArticleRepository articleRepository; // Î©§Î≤Ñ Î≥ÄÏàòÎ°ú Ïì∞Í∏∞ ÏúÑÌï¥ ÏÑ†Ïñ∏
    @Autowired // ÏÉùÏÑ±Ïûê Ï£ºÏûÖ
    public ArticleService(ArticleRepository articleRepository) {
        this.articleRepository = articleRepository;
    }

    public Article save(Article article) {
        return articleRepository.save(article);
    }

    public Article findById(Long id){
        return articleRepository.findById(id);
    }

    public List<Article> findAll() {
        return articleRepository.findAll();
    }
}
```

---

### 4. Controller

```java
package com.example.CRUD_practice.controller;

import com.example.CRUD_practice.domain.Article;
import com.example.CRUD_practice.service.ArticleService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;

@Controller
public class ArticleController {

    private final ArticleService articleService;

    @Autowired
    public ArticleController(ArticleService articleService) {
        this.articleService = articleService;
    }

    @GetMapping
    public String index(Model model) {
        model.addAttribute("articles", articleService.findAll());
        return "index";
    }

    @GetMapping("/articles/create")
    public String input(Model model){
        model.addAttribute("article", new Article());
        return "create";
    }
    @PostMapping("/articles/create")
    public String save(@ModelAttribute Article article, Model model) {
        Article savedArticle = articleService.save(article);
        return "redirect:/articles/" + savedArticle.getId();
    }

    @GetMapping("/articles/{id}")
    public String article(@PathVariable Long id, Model model) {
        Article findArticle = articleService.findById(id);
        model.addAttribute("article", findArticle);
        return "detail";
    }
}
```

## Update, Delete

### 1. Service

```java
package com.example.CRUD_practice.service;

import com.example.CRUD_practice.domain.Article;
import com.example.CRUD_practice.repository.ArticleRepository;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Service;

import java.util.List;

@Service
public class ArticleService {

    private final ArticleRepository articleRepository; // Î©§Î≤Ñ Î≥ÄÏàòÎ°ú Ïì∞Í∏∞ ÏúÑÌï¥ ÏÑ†Ïñ∏
    @Autowired // ÏÉùÏÑ±Ïûê Ï£ºÏûÖ
    public ArticleService(ArticleRepository articleRepository) {
        this.articleRepository = articleRepository;
    }

    public Article save(Article article) {
        return articleRepository.save(article);
    }

    public void update(Long id, Article article) {
        articleRepository.update(id, article);
    }

    public void delete(Long id) {
        articleRepository.delete(id);
    }

    public Article findById(Long id){
        return articleRepository.findById(id);
    }

    public List<Article> findAll() {
        return articleRepository.findAll();
    }
}
```

---

### 2. Controller

```java
package com.example.CRUD_practice.controller;

import com.example.CRUD_practice.domain.Article;
import com.example.CRUD_practice.service.ArticleService;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.ModelAttribute;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;

@Controller
public class ArticleController {

    private final ArticleService articleService;

    @Autowired
    public ArticleController(ArticleService articleService) {
        this.articleService = articleService;
    }

    @GetMapping
    public String index(Model model) {
        model.addAttribute("articles", articleService.findAll());
        return "index";
    }

    @GetMapping("/articles/create")
    public String input(Model model){
        model.addAttribute("article", new Article());
        return "create";
    }
    @PostMapping("/articles/create")
    public String save(@ModelAttribute Article article, Model model) {
        Article savedArticle = articleService.save(article);
        return "redirect:/articles/" + savedArticle.getId();
    }

    @GetMapping("/articles/{id}")
    public String article(@PathVariable Long id, Model model) {
        Article findArticle = articleService.findById(id);
        model.addAttribute("article", findArticle);
        return "detail";
    }

    @GetMapping("/articles/{id}/edit")
    public String update_input(@PathVariable Long id, Model model) {
        Article findArticle = articleService.findById(id);
        model.addAttribute("article", findArticle);
        return "update";
    }

    @PostMapping("/articles/{id}/edit")
    public String update(@PathVariable Long id, @ModelAttribute Article article) {
        // @ModelAttribute : formÏóêÏÑú valueÍ∞íÏùÑ Í∞ÄÏßÄÍ≥† Í∞ôÏùÄ Ïù¥Î¶ÑÏùò Í∞ùÏ≤¥Í∞Ä ÏûàÏúºÎ©¥ Í∑∏ Í∞íÏùÑ ArticleÏóê Îß§Ìïë

        articleService.update(id, article);
        return "redirect:/articles/" + article.getId();
    }

    @GetMapping("/articles/{id}/delete")
    public String delete(@PathVariable Long id) {
        articleService.delete(id);
        return "redirect:/";
    }
}
```

## Template

### 1. create.html

```html
<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8">
  <link th:href="@{/css/bootstrap.min.css}"
        href="./css/bootstrap.min.css" rel="stylesheet">
  <style>
        .container {
            max-width: 560px;
        }
    </style>
</head>
<body>

<div class="container">

  <div class="py-5 text-center">
    <h2>Í≤åÏãúÍ∏Ä Îì±Î°ù Ìèº</h2>
  </div>

  <form action="detail.html" th:action th:object="${article}" method="post">
    <div>
      <label for="title">Ï†úÎ™©</label>
      <input type="text" id="title" th:field="*{title}" class="form-control" placeholder="Ï†úÎ™©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
    </div>
    <div>
      <label for="content">ÎÇ¥Ïö©</label>
      <input type="text" id="content" th:field="*{content}" class="form-control" placeholder="ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
    </div>
    <div>
      <label for="author">ÏûëÏÑ±Ïûê</label>
      <input type="text" id="author" th:field="*{author}" class="form-control" placeholder="ÏûëÏÑ±ÏûêÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî">
    </div>

    <div class="row">
      <div class="col">
        <button class="w-100 btn btn-primary btn-lg" type="submit">Í≤åÏãúÍ∏Ä Îì±Î°ù</button>
      </div>
      <div class="col">
        <button class="w-100 btn btn-secondary btn-lg"
                onclick="location.href='items.html'"
                th:onclick="|location.href='@{/}'|"
                type="button">Ï∑®ÏÜå</button>
      </div>
    </div>

  </form>

</div> <!-- /container -->
</body>
</html>
```

---

### 2. detail.html

```html
<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <link th:href="@{/css/bootstrap.min.css}"
          href="./css/bootstrap.min.css" rel="stylesheet">
    <style>
        .container {
            max-width: 560px;
        }
    </style>
</head>
<body>

<div class="container">

    <div class="py-5 text-center">
        <h2>Í≤åÏãúÍ∏Ä ÏÉÅÏÑ∏</h2>
    </div>

    <!-- Ï∂îÍ∞Ä -->
    <h2 th:if="${param.status}" th:text="'Ï†ÄÏû• ÏôÑÎ£å'"></h2>

    <div>
        <label for="articleId">Í≤åÏãúÍ∏Ä ID</label>
        <input type="text" id="articleId" name="articleId" class="form-control" value="1" th:value="${article.id}" readonly>
    </div>
    <div>
        <label for="title">Ï†úÎ™©</label>
        <input type="text" id="title" name="title" class="form-control" value="Ï†úÎ™©" th:value="${article.title}" readonly>
    </div>
    <div>
        <label for="content">ÎÇ¥Ïö©</label>
        <input type="text" id="content" name="content" class="form-control" value="ÎÇ¥Ïö©" th:value="${article.content}" readonly>
    </div>
    <div>
        <label for="author">ÏûëÏÑ±Ïûê</label>
        <input type="text" id="author" name="author" class="form-control" value="ÏûëÏÑ±Ïûê" th:value="${article.author}" readonly>
    </div>

    <hr class="my-4">

    <div class="row">
        <div class="col">
            <button class="w-100 btn btn-primary btn-lg"
                    th:onclick="|location.href='@{/articles/{articleId}/edit(articleId=${article.id})}'|"
                    type="button">Í≤åÏãúÍ∏Ä ÏàòÏ†ï</button>
        </div>
        <div class="col">
            <button class="w-100 btn btn-secondary btn-lg"
                    th:onclick="|location.href='@{/}'|"
                    type="button">Î™©Î°ùÏúºÎ°ú</button>
        </div>
    </div>

</div> <!-- /container -->
</body>
</html>
```

---

### 3. index.html

```html
<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <link th:href="@{/css/bootstrap.min.css}"
          href="./css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<div class="container" style="max-width: 600px">
    <div class="py-5 text-center">
        <h2>Í≤åÏãúÍ∏Ä Î™©Î°ù</h2>
    </div>

    <div class="row">
        <div class="col">
            <button class="btn btn-primary float-end"
                    th:onclick="|location.href='@{/articles/create}'|"
                    type="button">Í≤åÏãúÍ∏Ä Îì±Î°ù</button>
        </div>
    </div>

    <hr class="my-4">
    <div>
        <table class="table">
            <thead>
            <tr>
                <th>ID</th>
                <th>Ï†úÎ™©</th>
                <th>ÏûëÏÑ±Ïûê</th>
                <th>ÎÇ¥Ïö©</th>
                <th>ÏÇ≠Ï†ú</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="article : ${articles}">
                <td><a href="article.html" th:href="@{/articles/{articleId}(articleId=${article.id})}" th:text="${article.id}">ÌöåÏõêid</a></td>
                <td><a href="article.html" th:href="@{|/articles/${article.id}|}" th:text="${article.title}">Ï†úÎ™©</a></td>
                <td th:text="${article.author}">ÏûëÏÑ±Ïûê</td>
                <td th:text="${article.content}">ÎÇ¥Ïö©</td>
                <td><button class="btn btn-primary float-end" th:onclick="|location.href='@{|/articles/${article.id}/delete|}'|" type="button">ÏÇ≠Ï†úÌïòÍ∏∞</button></td>
            </tr>
            </tbody>
        </table>
    </div>

</div> <!-- /container -->

</body>
</html>
```

---

### 4. update.html

```html
<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="utf-8">
  <link th:href="@{/css/bootstrap.min.css}"
        href="./css/bootstrap.min.css" rel="stylesheet">
  <style>
        .container {
            max-width: 560px;
        }
    </style>
</head>
<body>

<div class="container">

  <div class="py-5 text-center">
    <h2>Í≤åÏãúÍ∏Ä ÏÉÅÏÑ∏</h2>
  </div>

  <!-- Ï∂îÍ∞Ä -->
  <h2 th:if="${param.status}" th:text="'Ï†ÄÏû• ÏôÑÎ£å'"></h2>

  <form action="detail.html" th:action th:object="${article}" method="post">
    <div>
      <label for="articleId">Í≤åÏãúÍ∏Ä ID</label>
      <input type="text" id="articleId" name="articleId" class="form-control" value="1" th:value="${article.id}" readonly>
    </div>
    <div>
      <label for="title">Ï†úÎ™©</label>
      <input type="text" id="title" name="title" class="form-control" value="Ï†úÎ™©" th:value="${article.title}">
    </div>
    <div>
      <label for="content">ÎÇ¥Ïö©</label>
      <input type="text" id="content" name="content" class="form-control" value="ÎÇ¥Ïö©" th:value="${article.content}">
    </div>
    <div>
      <label for="author">ÏûëÏÑ±Ïûê</label>
      <input type="text" id="author" name="author" class="form-control" value="ÏûëÏÑ±Ïûê" th:value="${article.author}" readonly>
    </div>

    <hr class="my-4">

    <div class="row">
      <div class="col">
        <button class="w-100 btn btn-primary btn-lg"
                type="submit">Ï†ÄÏû•</button>
      </div>
      <div class="col">
        <button class="w-100 btn btn-secondary btn-lg"
                th:onclick="|location.href='@{/}'|"
                type="button">Î™©Î°ùÏúºÎ°ú</button>
      </div>
    </div>
  </form>
</div> <!-- /container -->
</body>
</html>
```

---